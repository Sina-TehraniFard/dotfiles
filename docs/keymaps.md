# キーマップ一覧

dotvim の全キーマップをカテゴリ別にまとめたクイックリファレンスです。

---

## リーダーキー

`<Space>` がリーダーキーとして設定されています。

以下のドキュメントで `<leader>` は `Space` キーを意味します。

---

## 目次

1. [基本操作](#基本操作)
2. [ファイル・バッファ操作](#ファイルバッファ操作)
3. [ウィンドウ操作](#ウィンドウ操作)
4. [検索・置換](#検索置換)
5. [LSP機能](#lsp機能)
6. [Git操作](#git操作)
7. [コメント操作](#コメント操作)
8. [括弧・引用符操作](#括弧引用符操作)
9. [テキストオブジェクト](#テキストオブジェクト)
10. [Markdown・ライティング](#markdownライティング)
11. [その他](#その他)

---

## 基本操作

### モード切り替え

| キー | モード | 機能 |
|------|--------|------|
| `jk` | Insert | ノーマルモードへ戻る |
| `<Esc>` | Normal | 検索ハイライトを消す |

### 保存・終了

| キー | モード | 機能 |
|------|--------|------|
| `<C-s>` | Normal | ファイル保存 |
| `<C-s>` | Insert | ファイル保存してノーマルモードへ |

### クリップボード

| キー | モード | 機能 |
|------|--------|------|
| `<C-c>` | Visual | 選択範囲をクリップボードにコピー |
| `<C-v>` | Normal | クリップボードからペースト |
| `<C-v>` | Insert | クリップボードからペースト |
| `<C-v>` | Visual | クリップボードからペースト |
| `Y` | Normal | カーソル位置から行末までヤンク |
| `p` | Visual | ペースト（元のテキストでレジスタを上書きしない） |

### 行操作

| キー | モード | 機能 |
|------|--------|------|
| `<A-j>` | Normal | 行を下に移動 |
| `<A-k>` | Normal | 行を上に移動 |
| `<A-j>` | Insert | 行を下に移動 |
| `<A-k>` | Insert | 行を上に移動 |
| `<A-j>` | Visual | 選択範囲を下に移動 |
| `<A-k>` | Visual | 選択範囲を上に移動 |

### インデント

| キー | モード | 機能 |
|------|--------|------|
| `<` | Visual | インデントを減らす（選択を維持） |
| `>` | Visual | インデントを増やす（選択を維持） |

---

## ファイル・バッファ操作

### ファイル検索（Telescope）

| キー | 機能 |
|------|------|
| `<leader>ff` | ファイル検索 |
| `<leader>fg` | テキスト検索（grep） |
| `<leader>fb` | バッファ一覧 |
| `<leader>fh` | ヘルプタグ検索 |
| `<leader>fr` | 最近開いたファイル |
| `<leader>fs` | ドキュメントシンボル検索 |
| `<leader>fw` | ワークスペースシンボル検索 |
| `<leader>fd` | 診断一覧 |
| `<leader>fc` | コマンド一覧 |
| `<leader>fk` | キーマップ一覧 |
| `<C-p>` | Gitファイル検索 |

### Telescope内操作

| キー | 機能 |
|------|------|
| `<C-j>` | 次の項目へ |
| `<C-k>` | 前の項目へ |
| `<C-q>` | 選択をQuickfixに送る |
| `<Esc>` | 閉じる |
| `q` | 閉じる（Normalモード） |

### ファイルツリー（Neo-tree）

| キー | 機能 |
|------|------|
| `<leader>e` | ファイルツリーの表示/非表示 |
| `<leader>o` | ファイルツリーにフォーカス |

### ファイルツリー内操作

| キー | 機能 |
|------|------|
| `<CR>` / `o` | ファイルを開く |
| `s` | 水平分割で開く |
| `v` | 垂直分割で開く |
| `t` | 新しいタブで開く |
| `a` | 新規ファイル/フォルダ作成 |
| `d` | 削除 |
| `r` | 名前変更 |
| `y` | クリップボードにコピー |
| `x` | カット |
| `p` | ペースト |
| `c` | コピー |
| `m` | 移動 |
| `q` | 閉じる |
| `R` | 更新 |
| `?` | ヘルプ |
| `<` | 前のソースへ |
| `>` | 次のソースへ |

### バッファ操作

| キー | 機能 |
|------|------|
| `<S-h>` | 前のバッファ |
| `<S-l>` | 次のバッファ |
| `<leader>bd` | 現在のバッファを閉じる |

---

## ウィンドウ操作

### ウィンドウ間移動

| キー | 機能 |
|------|------|
| `<C-h>` | 左のウィンドウへ |
| `<C-j>` | 下のウィンドウへ |
| `<C-k>` | 上のウィンドウへ |
| `<C-l>` | 右のウィンドウへ |

### ウィンドウサイズ変更

| キー | 機能 |
|------|------|
| `<C-Up>` | 高さを増やす |
| `<C-Down>` | 高さを減らす |
| `<C-Left>` | 幅を減らす |
| `<C-Right>` | 幅を増やす |

---

## 検索・置換

### 検索ナビゲーション

| キー | 機能 |
|------|------|
| `<Esc>` | 検索ハイライトを消す |
| `<leader>ft` | TODOコメント検索 |
| `]t` | 次のTODOへ |
| `[t` | 前のTODOへ |

### Quickfix

| キー | 機能 |
|------|------|
| `<leader>co` | Quickfixを開く |
| `<leader>cc` | Quickfixを閉じる |
| `[q` | 前のQuickfix項目 |
| `]q` | 次のQuickfix項目 |

---

## LSP機能

### ナビゲーション

| キー | 機能 |
|------|------|
| `gd` | 定義へジャンプ |
| `gD` | 宣言へジャンプ |
| `gi` | 実装へジャンプ |
| `gr` | 参照一覧を表示 |
| `gy` | 型定義へジャンプ |

### 情報表示

| キー | モード | 機能 |
|------|--------|------|
| `K` | Normal | ホバー情報（ドキュメント）表示 |
| `<C-k>` | Insert | シグネチャヘルプ表示 |

### コードアクション

| キー | モード | 機能 |
|------|--------|------|
| `<leader>rn` | Normal | シンボルをリネーム |
| `<leader>ca` | Normal/Visual | コードアクション |
| `<leader>f` | Normal | コードフォーマット |

### ワークスペース

| キー | 機能 |
|------|------|
| `<leader>wa` | ワークスペースフォルダを追加 |
| `<leader>wr` | ワークスペースフォルダを削除 |
| `<leader>wl` | ワークスペースフォルダ一覧 |

### 診断

| キー | 機能 |
|------|------|
| `[d` | 前の診断へ |
| `]d` | 次の診断へ |
| `<leader>d` | 診断をフロート表示 |
| `<leader>q` | 診断をロケーションリストに |

### 補完（nvim-cmp）

| キー | モード | 機能 |
|------|--------|------|
| `<Tab>` | Insert/Select | 次の補完候補 / スニペット展開 |
| `<S-Tab>` | Insert/Select | 前の補完候補 |
| `<CR>` | Insert | 補完を確定 |
| `<C-Space>` | Insert | 補完メニューを表示 |
| `<C-e>` | Insert | 補完をキャンセル |
| `<C-b>` | Insert | ドキュメントを上にスクロール |
| `<C-f>` | Insert | ドキュメントを下にスクロール |

### インクリメンタル選択

| キー | 機能 |
|------|------|
| `<C-Space>` | 選択開始 / 選択範囲を拡大 |
| `<BS>` | 選択範囲を縮小 |

---

## Git操作

### gitsigns

| キー | 機能 |
|------|------|
| `]h` | 次の変更箇所（hunk）へ |
| `[h` | 前の変更箇所（hunk）へ |
| `<leader>hs` | 変更箇所をステージ |
| `<leader>hr` | 変更箇所をリセット |
| `<leader>hS` | バッファ全体をステージ |
| `<leader>hu` | ステージを取り消し |
| `<leader>hR` | バッファ全体をリセット |
| `<leader>hp` | 変更箇所をプレビュー |
| `<leader>hb` | 行のblame表示 |
| `<leader>tb` | 行blameのトグル |
| `<leader>hd` | diff表示 |
| `<leader>hD` | diff表示（HEAD~との比較） |
| `<leader>td` | 削除行表示のトグル |

### LazyGit

| キー | 機能 |
|------|------|
| `<leader>gg` | LazyGitを開く |
| `<leader>gf` | 現在のファイルの履歴（LazyGit） |

### Diffview

| キー | 機能 |
|------|------|
| `<leader>gd` | Diffviewを開く |
| `<leader>gc` | Diffviewを閉じる |
| `<leader>gh` | ファイル履歴 |

---

## コメント操作

### Comment.nvim

| キー | モード | 機能 |
|------|--------|------|
| `gcc` | Normal | 行をコメントトグル |
| `gc{motion}` | Normal | 指定範囲をコメントトグル |
| `gcap` | Normal | 段落をコメントトグル |
| `gc` | Visual | 選択範囲をコメントトグル |

---

## 括弧・引用符操作

### nvim-surround

| キー | モード | 機能 | 例 |
|------|--------|------|-----|
| `ys{motion}{char}` | Normal | 囲みを追加 | `ysiw"` → word を "word" に |
| `yss{char}` | Normal | 行全体を囲む | `yss)` → 行を () で囲む |
| `cs{char1}{char2}` | Normal | 囲みを変更 | `cs"'` → "text" を 'text' に |
| `ds{char}` | Normal | 囲みを削除 | `ds"` → "text" を text に |
| `S{char}` | Visual | 選択範囲を囲む | `S"` → 選択を "" で囲む |

**よく使う囲み文字:**
| 文字 | 結果 |
|------|------|
| `"` | `"text"` |
| `'` | `'text'` |
| `)` / `b` | `(text)` |
| `]` | `[text]` |
| `}` / `B` | `{text}` |
| `>` | `<text>` |
| `t` | `<tag>text</tag>` |

---

## テキストオブジェクト

### Treesitter テキストオブジェクト

| キー | 対象 |
|------|------|
| `af` | 関数全体（outer） |
| `if` | 関数の中身（inner） |
| `ac` | クラス全体（outer） |
| `ic` | クラスの中身（inner） |
| `aa` | 引数全体（outer） |
| `ia` | 引数の中身（inner） |

### Git hunk テキストオブジェクト

| キー | 対象 |
|------|------|
| `ih` | 変更箇所（hunk） |

### ナビゲーション

| キー | 移動先 |
|------|--------|
| `]m` | 次の関数開始 |
| `]M` | 次の関数終了 |
| `[m` | 前の関数開始 |
| `[M` | 前の関数終了 |
| `]]` | 次のクラス開始 |
| `][` | 次のクラス終了 |
| `[[` | 前のクラス開始 |
| `[]` | 前のクラス終了 |

---

## Markdown・ライティング

### Markdownプレビュー

| キー | 機能 |
|------|------|
| `<leader>mp` | プレビューのトグル |

### Obsidian

| キー | 機能 |
|------|------|
| `<leader>on` | 新規ノート作成 |
| `<leader>oo` | Obsidianアプリで開く |
| `<leader>os` | ノート検索 |
| `<leader>oq` | クイック切り替え |
| `<leader>ob` | バックリンク表示 |
| `<leader>ot` | タグ検索 |
| `<leader>od` | 今日のデイリーノート |
| `<leader>oy` | 昨日のデイリーノート |
| `<leader>ol` | 選択範囲をリンク化（Visual） |
| `<leader>of` | リンク先へ移動 |

---

## その他

### 通知（noice）

| キー | 機能 |
|------|------|
| `<leader>nl` | 最後の通知を表示 |
| `<leader>nh` | 通知履歴 |
| `<leader>na` | 全ての通知 |
| `<leader>nd` | 通知を消す |

### ヘルプ・特殊バッファ

以下のファイルタイプでは `q` で閉じることができます：
- help
- man
- quickfix
- lspinfo
- checkhealth

### which-key グループ

`<leader>` を押すと以下のグループが表示されます：

| プレフィックス | グループ名 |
|----------------|------------|
| `<leader>f` | Find（検索） |
| `<leader>g` | Git |
| `<leader>b` | Buffer |
| `<leader>c` | Code/Quickfix |
| `<leader>w` | Workspace |
| `<leader>r` | Rename |
| `<leader>h` | Git Hunk |
| `<leader>t` | Toggle |
| `<leader>o` | Obsidian |
| `<leader>n` | Noice |
| `<leader>m` | Markdown |
